var be=Object.defineProperty,Ne=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var W=(t,e,r)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,E=(t,e)=>{for(var r in e||(e={}))Le.call(e,r)&&W(t,r,e[r]);if(te)for(var r of te(e))Fe.call(e,r)&&W(t,r,e[r]);return t},N=(t,e)=>Ne(t,Ie(e));var S=(t,e,r)=>(W(t,typeof e!="symbol"?e+"":e,r),r);import{l as re,j as z,R as D,r as _,a as Ae,T as ne,c as Oe,S as k,b as De}from"./vendor.1413e082.js";const Re=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}};Re();const ie=[{version:"4.5.4",packageName:"typescript-4.5.4"},{version:"4.4.4",packageName:"typescript-4.4.4"},{version:"4.3.5",packageName:"typescript-4.3.5"},{version:"4.2.4",packageName:"typescript-4.2.4"},{version:"4.1.5",packageName:"typescript-4.1.5"},{version:"4.0.5",packageName:"typescript-4.0.5"},{version:"3.9.7",packageName:"typescript-3.9.7"},{version:"3.8.3",packageName:"typescript-3.8.3"},{version:"3.7.5",packageName:"typescript-3.7.5"},{version:"3.6.4",packageName:"typescript-3.6.4"},{version:"@next (4.7.0-dev.20220215)",packageName:"typescript-next"}],y={options:{id:"options",buttonId:"optionsButton",compilerVersionSelectionId:"compilerVersionSelection",treeModeId:"treeMode",bindingEnabledId:"bindingEnabled",showFactoryCodeId:"showFactoryCode",showInternalsId:"showInternals"},mainCodeEditor:{id:"codeEditor"},factoryCodeEditor:{id:"factoryCodeEditor"},treeViewer:{id:"treeViewer",selectedNodeClass:"selected"},properties:{node:{id:"node"},type:{id:"type"},symbol:{id:"symbol"},signature:{id:"signature"}}},Pe={sourceFileRefreshDelay:150};var T;(function(t){t[t.forEachChild=0]="forEachChild",t[t.getChildren=1]="getChildren"})(T||(T={}));const xe="SET_CODE",oe="SET_API_LOADING_STATE",se="REFRESH_SOURCEFILE",Ve="SET_SELECTED_NODE",je="SET_OPTIONS";function U(t){return{type:oe,loadingState:t}}function Me(t){return{type:se,api:t}}const ke="modulepreload",ae={},Ke="/",l=function(e,r){return!r||r.length===0?e():Promise.all(r.map(n=>{if(n=`${Ke}${n}`,n in ae)return;ae[n]=!0;const i=n.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${o}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":ke,i||(a.as="script",a.crossOrigin=""),a.href=n,document.head.appendChild(a),i)return new Promise((c,u)=>{a.addEventListener("load",c),a.addEventListener("error",u)})})).then(()=>e())};class ce{static from(e){const r=[];for(;;){const n=e.next();if(n.done)return r;r.push(n.value)}}static binarySearch(e,r){let n=e.length-1,i=0;for(;i<=n;){const o=Math.floor((n+i)/2),a=r(e[o]);if(a===0)return o;a<0?n=o-1:i=o+1}return-1}constructor(){}}function L(t,e){throw new Error(e)}class He{constructor(e){this.value=e}}class $e{constructor(){}static getNames(e){return Object.keys(e).filter(r=>typeof e[r]=="number")}static getValues(e){return Object.keys(e).map(r=>e[r]).filter(r=>typeof r=="number")}static getNamesForValues(e){const r={};for(const n of this.getNames(e)){const i=e[n];r[i]==null&&(r[i]=[]),r[i].push(n)}return Object.keys(r).map(n=>({value:parseInt(n,10),names:r[n]}))}}function Be(t,e){const n=Object.keys(t).map(i=>t[i]).filter(i=>typeof i=="number").filter(i=>(i&e)!=0);return n.filter((i,o)=>n.indexOf(i)===o).map(i=>{const o=Math.log2(i);return Number.isInteger(o)?`${t[i]} (2 ^ ${o})`:t[i]})}function R(t,e){return We(t)[e]}const J={};function We(t){return J[t.tsAstViewer.packageName]==null&&(J[t.tsAstViewer.packageName]=ze(t)),J[t.tsAstViewer.packageName]}function ze(t){const e={};for(const r of Object.keys(t.SyntaxKind).filter(n=>isNaN(parseInt(n,10)))){const n=t.SyntaxKind[r];e[n]==null&&(e[n]=r)}return e}function Ue(t){const e=[];let r=0;for(let i=0;i<t.length;i++)t[i]===`
`&&n(i);return n(t.length),e;function n(i){e.push({pos:r,length:i-r,number:e.length+1}),r=i+1}}class le{constructor(e){S(this,"lineInfos");this.text=e,this.lineInfos=Ue(e)}getNumberAndColumnFromPos(e){if(e<0)return{lineNumber:1,column:1};const r=ce.binarySearch(this.lineInfos,i=>e<i.pos?-1:e>=i.pos&&e<i.pos+i.length+1?0:1),n=r>=0?this.lineInfos[r]:this.lineInfos[this.lineInfos.length-1];return n==null?{lineNumber:1,column:1}:{lineNumber:n.number,column:Math.min(e-n.pos+1,n.length+1)}}getPosFromLineAndColumn(e,r){if(this.lineInfos.length===0||e<1)return 0;const n=this.lineInfos[e-1];if(n==null){const i=this.lineInfos[this.lineInfos.length-1];return i.pos+i.length}return n.pos+Math.min(n.length,r-1)}}function Je(t){return new Promise(e=>setTimeout(e,t))}const B=class{constructor(e=window.localStorage){S(this,"_cachedState");this.localStorage=e}get defaultState(){return{version:3,treeMode:T.forEachChild,showFactoryCode:!0,showInternals:!1}}get(){if(this._cachedState!=null)return this._cachedState;try{const e=this.localStorage.getItem(B._stateKey);if(e!=null){const r=Ge(JSON.parse(e)||this.defaultState);if(this.verifyData(r))return r}}catch(e){console.error("Problem getting state: "+e)}return this.defaultState}set(e){try{if(!this.verifyData(e))return;this.localStorage.setItem(B._stateKey,JSON.stringify(e)),this._cachedState=e}catch(r){console.error("Problem saving state: "+r)}}verifyData(e){return!(e.version!==3||e.treeMode!==T.forEachChild&&e.treeMode!==T.getChildren||typeof e.showFactoryCode!="boolean"||typeof e.showInternals!="boolean")}};let G=B;S(G,"_stateKey","tsSimpleAst_savedState");function Ge(t){return qe(t),Xe(t),t}function qe(t){t.version===1&&(t.showFactoryCode=!0,t.version=2)}function Xe(t){t.version===2&&(t.showInternals=!1,t.version=3)}class ue{getUrlCode(){if(document.location.hash&&document.location.hash.startsWith("#code"))try{const e=document.location.hash.replace("#code/","").trim();return re.exports.decompressFromEncodedURIComponent(e)||""}catch(e){console.error(e)}return""}updateUrl(e){e.length===0?r(""):r(`code/${re.exports.compressToEncodedURIComponent(e)}`);function r(n){window.history.replaceState(void 0,"",`#${n}`)}}}async function Qe(t){switch(t){case"typescript-4.5.4":return await l(()=>import("./typescript.084ff497.js").then(function(e){return e.t}),["assets/typescript.084ff497.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-4.4.4":return await l(()=>import("./typescript.56019ebd.js").then(function(e){return e.t}),["assets/typescript.56019ebd.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-4.3.5":return await l(()=>import("./typescript.c5aac51a.js").then(function(e){return e.t}),["assets/typescript.c5aac51a.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-4.2.4":return await l(()=>import("./typescript.4478e195.js").then(function(e){return e.t}),["assets/typescript.4478e195.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-4.1.5":return await l(()=>import("./typescript.4e824516.js").then(function(e){return e.t}),["assets/typescript.4e824516.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-4.0.5":return await l(()=>import("./typescript.6a064fa4.js").then(function(e){return e.t}),["assets/typescript.6a064fa4.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-3.9.7":return await l(()=>import("./typescript.1771b79b.js").then(function(e){return e.t}),["assets/typescript.1771b79b.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-3.8.3":return await l(()=>import("./typescript.a20e0462.js").then(function(e){return e.t}),["assets/typescript.a20e0462.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-3.7.5":return await l(()=>import("./typescript.9aa28ea5.js").then(function(e){return e.t}),["assets/typescript.9aa28ea5.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-3.6.4":return await l(()=>import("./typescript.358f1135.js").then(function(e){return e.t}),["assets/typescript.358f1135.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);case"typescript-next":return await l(()=>import("./typescript.8e74e8f6.js").then(function(e){return e.t}),["assets/typescript.8e74e8f6.js","assets/vendor.1413e082.js","assets/___vite-browser-external_commonjs-proxy.573fb29a.js"]);default:return L(t,`Not implemented version: ${t}`)}}async function Ye(t){switch(t){case"typescript-4.5.4":return await l(()=>import("./index.65f69513.js"),[]);case"typescript-4.4.4":return await l(()=>import("./index.9eb0ae70.js"),[]);case"typescript-4.3.5":return await l(()=>import("./index.d8525085.js"),[]);case"typescript-4.2.4":return await l(()=>import("./index.d9227da0.js"),[]);case"typescript-4.1.5":return await l(()=>import("./index.555d8a05.js"),[]);case"typescript-4.0.5":return await l(()=>import("./index.e4cf865b.js"),[]);case"typescript-3.9.7":return await l(()=>import("./index.47ff021f.js"),[]);case"typescript-3.8.3":return await l(()=>import("./index.ef5f0771.js"),[]);case"typescript-3.7.5":return await l(()=>import("./index.468a26c4.js"),[]);case"typescript-3.6.4":return await l(()=>import("./index.04c1167a.js"),[]);case"typescript-next":return await l(()=>import("./index.e8267efe.js"),[]);default:return L(t,`Not implemented version: ${t}`)}}async function Ze(t){switch(t){case"typescript-4.5.4":return(await l(()=>import("./typescript-4.5.4.f1edd8a6.js"),["assets/typescript-4.5.4.f1edd8a6.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-4.4.4":return(await l(()=>import("./typescript-4.4.4.ed7205a2.js"),["assets/typescript-4.4.4.ed7205a2.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-4.3.5":return(await l(()=>import("./typescript-4.3.5.a2036da6.js"),["assets/typescript-4.3.5.a2036da6.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-4.2.4":return(await l(()=>import("./typescript-4.2.4.d7a0df5a.js"),["assets/typescript-4.2.4.d7a0df5a.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-4.1.5":return(await l(()=>import("./typescript-4.1.5.e37fade8.js"),["assets/typescript-4.1.5.e37fade8.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-4.0.5":return(await l(()=>import("./typescript-4.0.5.beea2a36.js"),["assets/typescript-4.0.5.beea2a36.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-3.9.7":return(await l(()=>import("./typescript-3.9.7.22acadc9.js"),["assets/typescript-3.9.7.22acadc9.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-3.8.3":return(await l(()=>import("./typescript-3.8.3.7e0cc7f4.js"),["assets/typescript-3.8.3.7e0cc7f4.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-3.7.5":return(await l(()=>import("./typescript-3.7.5.69950aab.js"),["assets/typescript-3.7.5.69950aab.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-3.6.4":return(await l(()=>import("./typescript-3.6.4.572e15c7.js"),["assets/typescript-3.6.4.572e15c7.js","assets/mod.3748b2ba.js"])).generateFactoryCode;case"typescript-next":return(await l(()=>import("./typescript-next.c3a64298.js"),["assets/typescript-next.c3a64298.js","assets/mod.3748b2ba.js"])).generateFactoryCode;default:return L(t,`Not implemented version: ${t}`)}}async function et(t){switch(t){case"typescript-4.5.4":return await l(()=>import("./typescript-4.5.4.7e94a540.js"),[]);case"typescript-4.4.4":return await l(()=>import("./typescript-4.4.4.ba96d844.js"),[]);case"typescript-4.3.5":return await l(()=>import("./typescript-4.3.5.95defe89.js"),[]);case"typescript-4.2.4":return await l(()=>import("./typescript-4.2.4.62e94571.js"),[]);case"typescript-4.1.5":return await l(()=>import("./typescript-4.1.5.c5d1f475.js"),[]);case"typescript-4.0.5":return await l(()=>import("./typescript-4.0.5.6654067b.js"),[]);case"typescript-3.9.7":return await l(()=>import("./typescript-3.9.7.e492ae46.js"),[]);case"typescript-3.8.3":return await l(()=>import("./typescript-3.8.3.cfbc9611.js"),[]);case"typescript-3.7.5":return await l(()=>import("./typescript-3.7.5.5d5d8d10.js"),[]);case"typescript-3.6.4":return await l(()=>import("./typescript-3.6.4.41582475.js"),[]);case"typescript-next":return await l(()=>import("./typescript-next.286e32a2.js"),[]);default:return L(t,`Not implemented version: ${t}`)}}function tt(t,e,r){if(t==null||t===e)return r;const n=e.ScriptTarget[t.ScriptTarget[r.scriptTarget]],i=e.ScriptKind[t.ScriptKind[r.scriptKind]];return N(E({},r),{scriptTarget:n==null?e.ScriptTarget.Latest:n,scriptKind:i==null?e.ScriptKind.TSX:i})}function rt(t,e,r,n){const i=`/ts-ast-viewer${nt(t,n)}`,o=t.createSourceFile(i,e,r,!1,n);let a;return{sourceFile:o,bindingTools:c};function c(){return a==null&&(a=u()),a}function u(){const h={strict:!0,target:r,allowJs:!0,module:t.ModuleKind.ES2015},g=E({[i]:o},t.tsAstViewer.cachedSourceFiles),C={getSourceFile:(d,M,ee)=>g[d],getDefaultLibFileName:d=>"/"+t.getDefaultLibFileName(d),writeFile:()=>{},getCurrentDirectory:()=>"/",getDirectories:d=>[],fileExists:d=>g[d]!=null,readFile:d=>g[d]!=null?g[d].getFullText():void 0,getCanonicalFileName:d=>d,useCaseSensitiveFileNames:()=>!0,getNewLine:()=>`
`,getEnvironmentVariable:()=>""},m=t.createProgram([...Object.keys(g)],h,C);return{typeChecker:m.getTypeChecker(),program:m}}}function nt(t,e){switch(e){case t.ScriptKind.TS:return".ts";case t.ScriptKind.TSX:return".tsx";case t.ScriptKind.JS:return".js";case t.ScriptKind.JSX:return".jsx";case t.ScriptKind.JSON:return".json";case t.ScriptKind.External:case t.ScriptKind.Deferred:case t.ScriptKind.Unknown:return"";default:return L(e,`Not implemented ScriptKind: ${t.ScriptKind[e]}`)}}function de(t,e){switch(t){case T.getChildren:return r;case T.forEachChild:return n;default:return L(t,`Unhandled mode: ${t}`)}function r(i){return i.getChildren(e)}function n(i){const o=[];return i.forEachChild(a=>{o.push(a)}),o}}const P={},pe={};function it(t){return P[t]==null&&(P[t]=st(t),P[t].catch(()=>delete P[t])),P[t]}function ot(t){return pe[t]===!0}async function st(t){const e=Ye(t),r=Qe(t),n=E({},await r);n.tsAstViewer={packageName:t,cachedSourceFiles:{}};const i=await e;for(const a of o())n.tsAstViewer.cachedSourceFiles[a.fileName]=a;return pe[t]=!0,n;function o(){return Object.keys(i).map(a=>i[a]).map(a=>n.createSourceFile(a.fileName,a.text,n.ScriptTarget.Latest,!1,n.ScriptKind.TS))}}function q(t,e){const r=t.jsDoc;return r&&r.length>0?r[0].getStart(e):t.getStart(e)}function at(t,e,r,n){const i=de(t,e),o=n.SyntaxKind;let a={node:e,start:e.getStart(e)};return c(e),a.node;function c(g){const C=i(g);for(const m of C){if(m.kind!==o.SyntaxList){if(u(m.end))continue;const f=q(m,e);if(h(f))return;const d=m.kind===o.EndOfFileToken,M=a.start===f&&r[0]===f;!d&&!M&&(a={node:m,start:f})}c(m)}}function u(g){return g<r[0]}function h(g){return g>=r[0]&&g>r[1]}}const F={},ct={};function lt(t){return F[t]==null&&(F[t]=Ze(t),F[t].catch(()=>delete F[t]),F[t].then(()=>ct[t]=!0)),F[t]}const ut=new ue;function dt(t,e){switch(e.type){case Ve:return t.compiler==null?t:N(E({},t),{compiler:N(E({},t.compiler),{selectedNode:e.node})});case oe:return N(E({},t),{apiLoadingState:e.loadingState});case se:{const r=N(E({},t),{options:tt(t.compiler==null?void 0:t.compiler.api,e.api,t.options)});return pt(r.options.compilerPackageName,e.api,r,t.code,t.options),ut.updateUrl(t.code),r}case xe:return N(E({},t),{code:e.code});case je:return N(E({},t),{options:E(E({},t.options),e.options)});default:return t}}function pt(t,e,r,n,i){const{sourceFile:o,bindingTools:a}=rt(e,n,i.scriptTarget,i.scriptKind);r.compiler={packageName:t,api:e,sourceFile:o,bindingTools:a,selectedNode:o}}var b;(function(t){t[t.Loading=0]="Loading",t[t.Loaded=1]="Loaded",t[t.Error=2]="Error"})(b||(b={}));const s=z.exports.jsx,p=z.exports.jsxs,v=z.exports.Fragment,ht=99,ft=4,x=new G;console.log("[ts-ast-viewer]: Inspect the ts, sourceFile, node, symbol, type, signature, program, and checker/typeChecker global variables here in the console.");const he=D.createContext(void 0);function gt({children:t}){const[e,r]=_.exports.useReducer(dt,{apiLoadingState:b.Loading,code:new ue().getUrlCode(),options:{compilerPackageName:ie[0].packageName,treeMode:x.get().treeMode,scriptTarget:ht,scriptKind:ft,bindingEnabled:!0,showFactoryCode:x.get().showFactoryCode,showInternals:x.get().showInternals},compiler:void 0}),n={state:e,dispatch:r};return _.exports.useEffect(()=>{const i=new AbortController;return o(i.signal),()=>{i.abort()};async function o(a){const c=e.options.compilerPackageName,u=!ot(c);try{if(u?r(U(b.Loading)):await Je(Pe.sourceFileRefreshDelay),a.aborted)return;const h=await it(c);if(a.aborted)return;r(Me(h)),r(U(b.Loaded))}catch(h){console.error(h),u&&r(U(b.Error))}}},[e.code,e.options.scriptKind,e.options.scriptTarget,e.options.compilerPackageName,e.options.bindingEnabled]),_.exports.useEffect(()=>{const i=x.get();i.treeMode=e.options.treeMode,i.showFactoryCode=e.options.showFactoryCode,i.showInternals=e.options.showInternals,x.set(i)},[e.options.treeMode,e.options.showFactoryCode,e.options.showInternals]),_.exports.useEffect(()=>{if(e.compiler==null||e.compiler.selectedNode==null)return;const i=window,o=e.compiler.selectedNode;if(i.ts=e.compiler.api,i.node=o,i.selectedNode=o,i.sourceFile=e.compiler.sourceFile,e.options.bindingEnabled){const c=e.compiler.bindingTools();i.checker=c.typeChecker,i.typeChecker=c.typeChecker,i.program=c.program,i.type=a(()=>c.typeChecker.getTypeAtLocation(o)),i.symbol=a(()=>o.symbol||c.typeChecker.getSymbolAtLocation(o)),i.signature=a(()=>c.typeChecker.getSignatureFromDeclaration(o))}else i.checker=void 0,i.typeChecker=void 0,i.program=void 0,i.type=void 0,i.symbol=void 0,i.signature=void 0;function a(c){try{return c()}catch{return}}}),s(he.Provider,{value:n,children:t})}function mt(){const t=D.useContext(he);if(t==null)throw new Error("Context was undefined.");return t}function V(t){const{backgroundColor:e}=t;return s("div",{className:"verticallyCenter horizontallyCenter fillHeight",style:{backgroundColor:e},children:s(Ae.BeatLoader,{color:"#fff",loading:!0,size:25})})}class fe extends D.Component{constructor(e){super(e);S(this,"editor");S(this,"outerContainerRef",D.createRef());S(this,"disposables",[]);S(this,"deltaDecorations",[]);S(this,"lineAndColumnComputer",new le(""));this.state={position:0,lineNumber:1,column:1,editorComponent:void 0},this.editorDidMount=this.editorDidMount.bind(this);const r=l(()=>import("./index.10f29ca9.js"),["assets/index.10f29ca9.js","assets/editor.api.a0bc0ac4.js","assets/editor.api.513d2118.css","assets/vendor.1413e082.js"]);l(()=>import("./editor.main.5f80a86b.js"),["assets/editor.main.5f80a86b.js","assets/editor.main.c27f2fd7.css","assets/editor.api.a0bc0ac4.js","assets/editor.api.513d2118.css"]).then(n=>{n.languages.typescript.typescriptDefaults.setCompilerOptions({target:n.languages.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0}),r.then(i=>{this.setState({editorComponent:i.default})}).catch(i=>{console.error(i),this.setState({editorComponent:!1})})}).catch(n=>{console.error(n),this.setState({editorComponent:!1})})}render(){return this.updateHighlight(),p("div",{id:this.props.id,ref:this.outerContainerRef,className:e(this.props.showInfo),children:[s("div",{className:"editorContainer",children:this.getEditor()}),this.props.showInfo&&this.getInfo()]});function e(r){const n=["codeEditor"];return r&&n.push("hasInfo"),n.join(" ")}}componentWillUnmount(){for(const e of this.disposables)e.dispose();this.disposables.length=0}getInfo(){return p("div",{className:"editorInfo",children:["Pos ",this.state.position,", Ln ",this.state.lineNumber,", Col ",this.state.column]})}updateHighlight(){if(this.editor==null)return;this.lineAndColumnComputer.text!==this.props.text&&(this.lineAndColumnComputer=new le(this.props.text));const{highlight:e}=this.props,r=this.lineAndColumnComputer,n=i();if(this.deltaDecorations=this.editor.deltaDecorations(this.deltaDecorations,n==null?[]:[{range:n,options:{className:"editorRangeHighlight"}}]),n)try{this.editor.revealRangeInCenterIfOutsideViewport(n)}catch{}function i(){if(e==null)return;const o=r.getNumberAndColumnFromPos(e.start),a=r.getNumberAndColumnFromPos(e.end);return{startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:a.lineNumber,endColumn:a.column}}}getEditor(){return this.state.editorComponent==null?s(V,{backgroundColor:"#1e1e1e"}):this.state.editorComponent===!1?s("div",{className:"errorMessage",children:"Error loading code editor. Please refresh the page to try again."}):s(this.state.editorComponent,{width:"100%",height:"100%",value:this.props.text,theme:"vs-dark",language:"typescript",onChange:e=>this.props.onChange&&this.props.onChange(e),editorDidMount:this.editorDidMount,options:{automaticLayout:!1,renderWhitespace:this.props.renderWhiteSpace?"all":"none",minimap:{enabled:!1},readOnly:this.props.readOnly,quickSuggestions:!1,occurrencesHighlight:!1,selectionHighlight:!1,codeLens:!1,suggestOnTriggerCharacters:!1}})}editorDidMount(e,r){var a;this.editor=e,(a=e.getModel())==null||a.setEOL(r.editor.EndOfLineSequence.LF),this.disposables.push(e.onDidChangeCursorPosition(c=>{const u=e.getModel();u!=null&&this.setState({position:u.getOffsetAt(c.position),lineNumber:c.position.lineNumber,column:c.position.column})})),this.disposables.push(e.onMouseDown(c=>{if(c.target==null||c.target.range==null||this.props.onClick==null)return;const u=e.getPosition();if(u!=null){const h=this.lineAndColumnComputer.getPosFromLineAndColumn(u.lineNumber,u.column);this.props.onClick([h,h])}}));let n=0,i=0;const o=setInterval(()=>{const c=this.outerContainerRef.current;if(c==null)return;const u=c.offsetWidth,h=c.offsetHeight;n===h&&i===u||(e.layout(),n=h,i=u)},500);this.disposables.push({dispose:()=>clearInterval(o)}),this.updateHighlight(),this.props.editorDidMount&&this.props.editorDidMount(e,r)}}class ge extends D.Component{constructor(e){super(e);S(this,"lastResetHash");this.state={hasError:!1}}componentDidCatch(e,r){this.setState({hasError:!0,error:e,errorInfo:r}),console.error(e),this.props.getResetHash!=null&&(this.lastResetHash=this.props.getResetHash())}render(){return this.getHasError()?p("div",{children:[s("h2",{children:"Something went wrong"}),p("div",{style:{whiteSpace:"pre-wrap"},children:[s("div",{children:this.state.error&&this.state.error.toString()}),s("div",{children:this.state.errorInfo.componentStack})]})]}):this.props.children}getHasError(){return this.state.hasError?this.hasHashChanged()?(this.lastResetHash=void 0,this.setState({hasError:!1,error:void 0}),!1):!0:!1}hasHashChanged(){return this.props.getResetHash==null?!1:this.props.getResetHash()!==this.lastResetHash}}function yt(t){const[e,r]=_.exports.useState();if(_.exports.useEffect(()=>{r(void 0),lt(t.compiler.packageName).then(i=>{r(new He(i))}).catch(i=>{console.error(i),r(!1)})},[t.compiler.packageName]),e==null)return s(V,{backgroundColor:"#1e1e1e"});if(e===!1)return s("div",{className:"errorMessage",children:"Error loading factory code. Please refresh the page to try again."});return s(fe,{id:y.factoryCodeEditor.id,editorDidMount:_t,text:n(),readOnly:!0});function n(){return e==null||e===!1?"":e.value(t.compiler.api,t.compiler.selectedNode)}}function _t(t){window.getFactoryCodeEditorText=()=>t.getValue()}function Et(t,e){const r=_.exports.useCallback(e,[e]);_.exports.useEffect(()=>{const n=i=>{!t.current||t.current.contains(i.target)||r(i)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n,!1),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n,!1)}},[r,t])}function me(t){return s("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",children:t.text})}function vt(t){const e=_.exports.useRef(null),[r,n]=_.exports.useState(!1);return Et(e,()=>n(!1)),p("div",{id:y.options.id,ref:e,children:[s("div",{id:y.options.buttonId,onClick:()=>n(!r),role:"button",children:"Options"}),s("div",{className:"menuLine",hidden:!r}),p("div",{className:"menu",hidden:!r,children:[i(),o(),a(),c(),u(),h(),g(),p("div",{className:"bottomLinks",children:[s(me,{text:"About",url:"https://github.com/dsherret/ts-ast-viewer/tree/main/docs/about.md"}),s("span",{children:"\xA0|\xA0"}),s(me,{text:"View on GitHub",url:"https://github.com/dsherret/ts-ast-viewer"})]})]})]});function i(){const f=s("select",{id:y.options.compilerVersionSelectionId,value:t.options.compilerPackageName,onChange:d=>m({compilerPackageName:d.target.value}),children:ie.map(d=>s("option",{value:d.packageName,children:d.version},d.packageName))});return s(A,{name:"Version",value:f})}function o(){const f=p("select",{id:y.options.treeModeId,value:t.options.treeMode,onChange:d=>m({treeMode:parseInt(d.target.value,10)}),children:[p("option",{value:T.forEachChild,children:["node.forEachChild(child =",">"," ...)"]}),s("option",{value:T.getChildren,children:"node.getChildren()"})]});return s(A,{name:"Tree mode",value:f})}function a(){const{api:f}=t;if(f!=null)return C("Script kind","ts.ScriptKind",f.ScriptKind,t.options.scriptKind,d=>m({scriptKind:d}))}function c(){const{api:f}=t;if(f!=null)return C("Script target","ts.ScriptTarget",f.ScriptTarget,t.options.scriptTarget,d=>m({scriptTarget:d}))}function u(){const f=s("div",{children:s("input",{id:y.options.bindingEnabledId,type:"checkbox",checked:t.options.bindingEnabled,onChange:d=>m({bindingEnabled:!!d.target.checked})})});return s(A,{name:"Binding",value:f})}function h(){const f=s("div",{children:s("input",{id:y.options.showFactoryCodeId,type:"checkbox",checked:t.options.showFactoryCode,onChange:d=>m({showFactoryCode:!!d.target.checked})})});return s(A,{name:"Factory code",value:f})}function g(){const f=s("div",{children:s("input",{id:y.options.showInternalsId,type:"checkbox",checked:t.options.showInternals,onChange:d=>m({showInternals:!!d.target.checked})})});return s(A,{name:"Show internals",value:f})}function C(f,d,M,ee,Ce){const Se=s("select",{value:ee,onChange:I=>Ce(parseInt(I.target.value,10)),children:$e.getNamesForValues(M).map(I=>we(I.value,I.names))});return s(A,{name:f,value:Se});function we(I,Te){return p("option",{value:I,children:[d,".",Te.join(" / ")]},I)}}function m(f){t.onChange(E({},f))}}function A(t){return p("div",{className:"option",children:[p("div",{className:"optionName",children:[t.name,":"]}),s("div",{className:"optionValue",children:t.value})]})}function X(t){const[e,r]=_.exports.useState(t.defaultCollapsed);return s(ne,{nodeLabel:t.nodeLabel,collapsed:e,onClick:n,children:e?void 0:t.getChildren()});function n(){r(!e)}}function Ct(t){const[e,r]=_.exports.useState(!1);return p("div",{className:"toolTippedText",onMouseEnter:n,onMouseLeave:n,children:[s("div",{className:"titleText",children:t.text}),e&&i()]});function n(){r(!e)}function i(){return s("div",{className:"tooltipText",children:t.children})}}function St(t){const[e,r]=_.exports.useState(void 0);_.exports.useEffect(()=>{r(void 0),et(t.compiler.packageName).then(u=>{r(u)}).catch(u=>{console.error(u),r(!1)})},[t.compiler.packageName]);const{selectedNode:n,sourceFile:i,bindingEnabled:o,bindingTools:a}=t,c={api:t.compiler.api,publicApiInfo:e,showInternals:t.showInternals,sourceFile:i};return e==null?s(V,{backgroundColor:"#1e1e1e"}):s("div",{className:"propertiesViewer",children:p("div",{className:"container",children:[s("h2",{children:"Node"}),s("div",{id:y.properties.node.id,children:Tt(c,n)}),o&&wt(c,n,a().typeChecker)]})})}function wt(t,e,r){return p(v,{children:[s("h2",{children:"Type"}),s("div",{id:y.properties.type.id,children:bt(t,e,r)}),s("h2",{children:"Symbol"}),s("div",{id:y.properties.symbol.id,children:Nt(t,e,r)}),s("h2",{children:"Signature"}),s("div",{id:y.properties.signature.id,children:It(t,e,r)}),s("h2",{children:"FlowNode"}),s("div",{children:Lt(t,e)})]})}function Tt(t,e){return s(X,{nodeLabel:R(t.api,e.kind),defaultCollapsed:!1,getChildren:r});function r(){const{sourceFile:o}=t;return p(v,{children:[Y(t,e),n("getChildCount()",e.getChildCount(o)),n("getFullStart()",e.getFullStart()),n("getStart()",e.getStart(o)),n("getStart(sourceFile, true)",q(e,o)),n("getFullWidth()",e.getFullWidth()),n("getWidth()",e.getWidth(o)),n("getLeadingTriviaWidth()",e.getLeadingTriviaWidth(o)),n("getFullText()",e.getFullText(o)),n("getText()",o.text.substring(e.getStart(t.sourceFile),e.getEnd())),i(`ts.getLeadingCommentRanges(fileFullText, ${e.getFullStart()})`,t.api.getLeadingCommentRanges(t.sourceFile.text,e.getFullStart())),i(`ts.getTrailingCommentRanges(fileFullText, ${e.end})`,t.api.getTrailingCommentRanges(t.sourceFile.text,e.end))]})}function n(o,a){return w(o,typeof a=="string"?a:JSON.stringify(a))}function i(o,a){return a==null?w(o,"undefined"):ye(t,o,a)}}function bt(t,e,r){if(e.kind===t.api.SyntaxKind.SourceFile)return s(v,{children:"[None]"});const n=Q(()=>r.getTypeAtLocation(e));if(n==null)return s(v,{children:"[None]"});if(typeof n=="string")return p(v,{children:["[Error getting type: ",n,"]"]});return K(t,n,i()||"Type");function i(){try{return r.typeToString(n,e)}catch(o){return`[Problem getting type text: ${o}]`}}}function Nt(t,e,r){const n=Q(()=>e.symbol||r.getSymbolAtLocation(e));if(n==null)return s(v,{children:"[None]"});if(typeof n=="string")return p(v,{children:["[Error getting symbol: ",n,"]"]});return K(t,n,i()||"Symbol");function i(){try{return n.getName()}catch(o){return`[Problem getting symbol name: ${o}]`}}}function It(t,e,r){const n=Q(()=>r.getSignatureFromDeclaration(e));return n==null||typeof n=="string"?s(v,{children:"[None]"}):K(t,n,"Signature")}function Lt(t,e,r){const n=e;return n.flowNode==null?s(v,{children:"[None]"}):K(t,n.flowNode,"FlowNode")}function Q(t){try{return t()}catch(e){return JSON.stringify(e)}}function K(t,e,r){return s(X,{nodeLabel:r,defaultCollapsed:!1,getChildren:()=>Y(t,e)})}function Y(t,e){const r=Ee(t,e);return s(v,{children:r.map(o=>{const a=i(o.key,o.value,e);return o.permission==="internal"?s("div",{className:"internal","data-name":o.key,children:a},o.key):a})});function i(o,a,c){return a===null?w(o,"null"):a===void 0?w(o,"undefined"):a instanceof Array?ye(t,o,a):O(a)?Dt(t,o,a):Vt(a)?Ft(t,o,a):typeof a=="object"?At(t,o,a):Ot(t,o,a,c)}}function ye(t,e,r){return r.length===0?w(e,"[]"):p("div",{className:"array","data-name":e,children:[p("div",{className:"key",children:[e,": ["]}),s("div",{className:"value",children:r.map((n,i)=>H(t,n,void 0,i))}),s("div",{className:"suffix",children:"]"})]},e)}function Ft(t,e,r){const n=ce.from(r.entries());return n.length===0?w(e,"{}"):p("div",{className:"array","data-name":e,children:[p("div",{className:"key",children:[e,":","{"]}),s("div",{className:"value",children:n.map((i,o)=>H(t,i[1],i[0],o))}),s("div",{className:"suffix",children:"}"})]},e)}function At(t,e,r){return Ee(t,r).length===0?w(e,"{}"):p("div",{className:"object","data-name":e,children:[p("div",{className:"key",children:[e,":"]}),s("div",{className:"value",children:H(t,r)})]},e)}function Ot(t,e,r,n){return p("div",{className:"text","data-name":e,children:[p("div",{className:"key",children:[e,":"]}),s("div",{className:"value",children:i()})]},e);function i(){if(O(n))switch(e){case"kind":return`${r} (SyntaxKind.${R(t.api,r)})`;case"flags":return j(t.api.NodeFlags,r)}return $(n)&&e==="objectFlags"?j(t.api.ObjectFlags,r):$(n)&&e==="flags"?j(t.api.TypeFlags,r):Z(n)&&e==="flags"?j(t.api.SymbolFlags,r):jt(n)&&e==="flags"?j(t.api.FlowFlags,r):Oe.stringify(r)}}function Dt(t,e,r){return p("div",{className:"object","data-name":e,children:[p("div",{className:"key",children:[e,":"]}),s("div",{className:"value",children:H(t,r)})]},e)}function w(t,e){return p("div",{className:"text","data-name":t,children:[t==null?void 0:p("div",{className:"key",children:[t,":"]}),s("div",{className:"value",children:e})]},t)}function H(t,e,r,n){const i=_e(t,e);if(r=o(),typeof e=="string")return w(r,`"${e}"`);if(typeof e=="number"||typeof e=="boolean")return w(r,e.toString());return s(X,{nodeLabel:r,defaultCollapsed:!0,getChildren:()=>Y(t,e)},n);function o(){return r==null?i:i!=null?`${r}: ${_e(t,e)}`:r}}function _e(t,e){if(e==null)return;if(O(e))return n(R(t.api,e.kind));if(ve(e))return n("Signature");if($(e))return n("Type");if(Z(e))return n("Symbol");const r=typeof e;if(r==="string"||r==="number"||r==="boolean")return;return n("Object");function n(o){const a=i();return a==null?o:`${o} (${a})`}function i(){try{return typeof e.getName=="function"?e.getName():O(e)&&e.name!=null?e.name.getText():void 0}catch{return}}}function Ee(t,e){return e==null?[]:Object.keys(e).map(r=>({key:r,permission:xt(t,e,r),value:e[r]})).filter(r=>r.permission===!1?!1:t.showInternals||r.permission!=="internal")}const Rt=new Set(["parent","_children","symbol"]),Pt=new Set(["checker","symbol"]);function xt(t,e,r){const{publicApiInfo:n}=t;if(O(e)){if(Rt.has(r))return!1;if(!n)return!0;const o=R(t.api,e.kind);return i(n.nodePropertiesBySyntaxKind.get(o))}if($(e))return!Pt.has(r)&&i(n&&n.typeProperties);if(ve(e))return i(n&&n.signatureProperties);if(Z(e))return i(n&&n.symbolProperties);return!0;function i(o){return o?o.has(r)?!0:"internal":!0}}function Vt(t){return typeof t.keys=="function"&&typeof t.values=="function"}function O(t){return typeof t.kind=="number"}function $(t){return t.getBaseTypes!=null}function Z(t){return t.getDeclarations!=null}function ve(t){return t.declaration==null?!1:O(t.declaration)}function jt(t){return t.antecedents!=null||t.antecedent!=null}function j(t,e){const r=Be(t,e);if(r.length===0)return s(v,{children:e});return s(Ct,{text:e.toString(),children:n()});function n(){return s("ul",{children:r.map((i,o)=>s("li",{children:i},o))})}}function Mt(t){const{sourceFile:e,selectedNode:r,onSelectNode:n,mode:i,api:o}=t;let a=0;return _.exports.useLayoutEffect(()=>{const u=document.getElementById(y.treeViewer.id),h=document.querySelector(`#${y.treeViewer.id} .${y.treeViewer.selectedNodeClass}`);if(u&&h){const g=h.getBoundingClientRect(),C=u.getBoundingClientRect();(g.y<0||g.y+g.height>C.height)&&h.scrollIntoView({block:"center",inline:"center"})}},[r]),s("div",{id:y.treeViewer.id,children:c(e,de(i,e))});function c(u,h){const g=h(u),C="nodeText"+(u===r?" "+y.treeViewer.selectedNodeClass:""),m=R(o,u.kind),f=s("div",{onClick:()=>n(u),className:C,children:m});return g.length===0?s("div",{className:"endNode","data-name":m,children:f},a++):s("div",{"data-name":m,children:s(ne,{nodeLabel:f,children:g.map(d=>c(d,h))})},a++)}}function kt(){const{state:t,dispatch:e}=mt(),r=t.compiler;return s("div",{className:"App",children:p(k,{split:"horizontal",defaultSize:50,allowResize:!1,children:[p("header",{className:"AppHeader clearfix",children:[s("h2",{id:"title",children:"TypeScript AST Viewer"}),s(vt,{api:r==null?void 0:r.api,options:t.options,onChange:c=>e({type:"SET_OPTIONS",options:c})})]}),p(k,{split:"vertical",minSize:50,defaultSize:"33%",children:[i(),o()]})]})});function n(){if(r==null)return;const{selectedNode:c,sourceFile:u}=r;return c===u?void 0:{start:q(c,u),end:c.end}}function i(){if(t.options.showFactoryCode)return p(k,{split:"horizontal",defaultSize:window.innerHeight*.7,children:[u(),c()]});return u();function c(){return r==null||t.apiLoadingState===b.Loading?s(V,{}):s(ge,{getResetHash:()=>t.code,children:s(yt,{compiler:r})})}function u(){return s(fe,{id:y.mainCodeEditor.id,onChange:h=>e({type:"SET_CODE",code:h}),onClick:h=>{if(r==null)return;const g=at(t.options.treeMode,r.sourceFile,h,r.api);e({type:"SET_SELECTED_NODE",node:g})},text:t.code,highlight:n(),showInfo:!0,renderWhiteSpace:!0,editorDidMount:a})}}function o(){return r==null||t.apiLoadingState===b.Loading?s(V,{}):t.apiLoadingState===b.Error?s("div",{className:"errorMessage",children:"Error loading compiler API. Please refresh the page to try again."}):s(ge,{children:p(k,{split:"vertical",minSize:50,defaultSize:"50%",children:[s(Mt,{api:r.api,selectedNode:r.selectedNode,sourceFile:r.sourceFile,onSelectNode:c=>e({type:"SET_SELECTED_NODE",node:c}),mode:t.options.treeMode}),s(St,{compiler:r,selectedNode:r.selectedNode,sourceFile:r.sourceFile,bindingTools:r.bindingTools,bindingEnabled:t.options.bindingEnabled,showInternals:t.options.showInternals})]})})}function a(c){setTimeout(()=>c.focus(),100),window.setMonacoEditorText=u=>{const h=c.getModel();h!=null&&c.executeEdits("my-source",[{range:h.getFullModelRange(),text:u}])}}}De.render(s(gt,{children:s(kt,{})}),document.getElementById("root"));
